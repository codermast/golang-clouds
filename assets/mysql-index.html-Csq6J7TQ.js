import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as t,a,o as l}from"./app-Cjxa952C.js";const e={};function n(h,s){return l(),t("div",null,[...s[0]||(s[0]=[a(`<h1 id="mysql-索引" tabindex="-1"><a class="header-anchor" href="#mysql-索引"><span>MySQL 索引</span></a></h1><p>索引是帮助 MySQL 高效获取数据的<strong>有序数据结构</strong>。</p><h2 id="索引结构" tabindex="-1"><a class="header-anchor" href="#索引结构"><span>索引结构</span></a></h2><h3 id="为什么用-b-tree" tabindex="-1"><a class="header-anchor" href="#为什么用-b-tree"><span>为什么用 B+Tree？</span></a></h3><table><thead><tr><th style="text-align:left;">数据结构</th><th style="text-align:left;">问题</th></tr></thead><tbody><tr><td style="text-align:left;">二叉树</td><td style="text-align:left;">顺序插入退化为链表</td></tr><tr><td style="text-align:left;">红黑树</td><td style="text-align:left;">本质还是二叉树，层级深</td></tr><tr><td style="text-align:left;">B-Tree</td><td style="text-align:left;">非叶子节点也存数据，单节点容量小</td></tr><tr><td style="text-align:left;">Hash</td><td style="text-align:left;">不支持范围查询、排序</td></tr></tbody></table><p><strong>B+Tree 优势：</strong></p><ul><li>非叶子节点只存索引，单节点可存更多 key</li><li>叶子节点形成有序链表，支持范围查询</li><li>层级低（3 层可存 2000W+ 数据）</li></ul><h3 id="b-tree-结构" tabindex="-1"><a class="header-anchor" href="#b-tree-结构"><span>B+Tree 结构</span></a></h3><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>                    [15|30|45]              &lt;- 根节点（只存索引）</span></span>
<span class="line"><span>                   /    |    \\</span></span>
<span class="line"><span>        [5|10|15]    [20|25|30]   [35|40|45]   &lt;- 分支节点</span></span>
<span class="line"><span>           |            |            |</span></span>
<span class="line"><span>    [1→3→5→7→10→12→15]→[17→20→23→25→28→30]→[32→35→38→40→42→45]</span></span>
<span class="line"><span>                                              &lt;- 叶子节点（存数据，有序链表）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="索引分类" tabindex="-1"><a class="header-anchor" href="#索引分类"><span>索引分类</span></a></h2><h3 id="按数据结构" tabindex="-1"><a class="header-anchor" href="#按数据结构"><span>按数据结构</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th><th style="text-align:left;">支持引擎</th></tr></thead><tbody><tr><td style="text-align:left;">B+Tree</td><td style="text-align:left;">最常用，支持范围查询</td><td style="text-align:left;">InnoDB, MyISAM</td></tr><tr><td style="text-align:left;">Hash</td><td style="text-align:left;">精确匹配快，不支持范围</td><td style="text-align:left;">Memory</td></tr><tr><td style="text-align:left;">Full-text</td><td style="text-align:left;">全文索引</td><td style="text-align:left;">InnoDB 5.6+, MyISAM</td></tr></tbody></table><h3 id="按逻辑分类" tabindex="-1"><a class="header-anchor" href="#按逻辑分类"><span>按逻辑分类</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th><th style="text-align:left;">关键字</th></tr></thead><tbody><tr><td style="text-align:left;">主键索引</td><td style="text-align:left;">唯一 + 非空</td><td style="text-align:left;">PRIMARY KEY</td></tr><tr><td style="text-align:left;">唯一索引</td><td style="text-align:left;">值唯一，可以有 NULL</td><td style="text-align:left;">UNIQUE</td></tr><tr><td style="text-align:left;">普通索引</td><td style="text-align:left;">无限制</td><td style="text-align:left;">INDEX</td></tr><tr><td style="text-align:left;">全文索引</td><td style="text-align:left;">文本搜索</td><td style="text-align:left;">FULLTEXT</td></tr></tbody></table><h3 id="innodb-索引分类" tabindex="-1"><a class="header-anchor" href="#innodb-索引分类"><span>InnoDB 索引分类</span></a></h3><table><thead><tr><th style="text-align:left;">类型</th><th style="text-align:left;">说明</th><th style="text-align:left;">特点</th></tr></thead><tbody><tr><td style="text-align:left;">聚簇索引</td><td style="text-align:left;">主键索引，叶子节点存完整数据</td><td style="text-align:left;">有且仅有一个</td></tr><tr><td style="text-align:left;">二级索引</td><td style="text-align:left;">非主键索引，叶子节点存主键值</td><td style="text-align:left;">可以有多个</td></tr></tbody></table><p><strong>聚簇索引选取规则：</strong></p><ol><li>有主键 → 主键索引</li><li>无主键 → 第一个 UNIQUE 非空索引</li><li>都没有 → 生成隐藏的 rowid</li></ol><h2 id="索引操作" tabindex="-1"><a class="header-anchor" href="#索引操作"><span>索引操作</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 创建索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> idx_name</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> UNIQUE INDEX</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> idx_email</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user(email);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> idx_name_age</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, age);  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 联合索引</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 查看索引</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SHOW </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">INDEX</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 删除索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DROP</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx_name </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 建表时创建索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> TABLE</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> user</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    id </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">BIGINT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> PRIMARY KEY</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    name</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> VARCHAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    email </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">VARCHAR</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx_name(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">),</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    UNIQUE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx_email(email)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="回表与覆盖索引" tabindex="-1"><a class="header-anchor" href="#回表与覆盖索引"><span>回表与覆盖索引</span></a></h2><h3 id="回表查询" tabindex="-1"><a class="header-anchor" href="#回表查询"><span>回表查询</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 假设 name 有索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;张三&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 执行过程：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 1. 在 name 的二级索引中找到 &#39;张三&#39; 对应的主键 id</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 2. 根据 id 在聚簇索引中查找完整数据</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 3. 这个过程叫&quot;回表&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="覆盖索引" tabindex="-1"><a class="header-anchor" href="#覆盖索引"><span>覆盖索引</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 假设有联合索引 (name, age)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, age </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;张三&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 执行过程：</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 1. 在联合索引中找到 &#39;张三&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 2. 索引中已包含 name 和 age，直接返回</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 3. 无需回表，这叫&quot;覆盖索引&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>优化原则：尽量使用覆盖索引，减少 <code>SELECT *</code></strong></p><h2 id="索引失效场景" tabindex="-1"><a class="header-anchor" href="#索引失效场景"><span>索引失效场景</span></a></h2><table><thead><tr><th style="text-align:left;">场景</th><th style="text-align:left;">示例</th><th style="text-align:left;">原因</th></tr></thead><tbody><tr><td style="text-align:left;">最左前缀不匹配</td><td style="text-align:left;">idx(a,b,c) 只查 b</td><td style="text-align:left;">联合索引从左匹配</td></tr><tr><td style="text-align:left;">索引列运算</td><td style="text-align:left;">WHERE YEAR(date) = 2024</td><td style="text-align:left;">函数破坏索引</td></tr><tr><td style="text-align:left;">类型隐式转换</td><td style="text-align:left;">WHERE phone = 123（phone是字符串）</td><td style="text-align:left;">类型不匹配</td></tr><tr><td style="text-align:left;">左模糊查询</td><td style="text-align:left;">WHERE name LIKE &#39;%张&#39;</td><td style="text-align:left;">无法利用索引</td></tr><tr><td style="text-align:left;">OR 条件无索引</td><td style="text-align:left;">WHERE a=1 OR b=2（b无索引）</td><td style="text-align:left;">全表扫描更快</td></tr><tr><td style="text-align:left;">范围查询右侧失效</td><td style="text-align:left;">idx(a,b) WHERE a&gt;1 AND b=2</td><td style="text-align:left;">b 的索引失效</td></tr></tbody></table><h3 id="最左前缀法则" tabindex="-1"><a class="header-anchor" href="#最左前缀法则"><span>最左前缀法则</span></a></h3><p>联合索引 <code>idx(a, b, c)</code>：</p><table><thead><tr><th style="text-align:left;">查询条件</th><th style="text-align:left;">是否走索引</th><th style="text-align:left;">使用的索引列</th></tr></thead><tbody><tr><td style="text-align:left;">a = 1</td><td style="text-align:left;">✅</td><td style="text-align:left;">a</td></tr><tr><td style="text-align:left;">a = 1 AND b = 2</td><td style="text-align:left;">✅</td><td style="text-align:left;">a, b</td></tr><tr><td style="text-align:left;">a = 1 AND b = 2 AND c = 3</td><td style="text-align:left;">✅</td><td style="text-align:left;">a, b, c</td></tr><tr><td style="text-align:left;">b = 2</td><td style="text-align:left;">❌</td><td style="text-align:left;">无</td></tr><tr><td style="text-align:left;">a = 1 AND c = 3</td><td style="text-align:left;">✅</td><td style="text-align:left;">a（c失效）</td></tr><tr><td style="text-align:left;">a &gt; 1 AND b = 2</td><td style="text-align:left;">✅</td><td style="text-align:left;">a（b失效）</td></tr></tbody></table><h2 id="索引设计原则" tabindex="-1"><a class="header-anchor" href="#索引设计原则"><span>索引设计原则</span></a></h2><ol><li><strong>频繁查询的字段</strong>建索引</li><li><strong>区分度高</strong>的字段优先（如手机号 &gt; 性别）</li><li><strong>字符串长字段</strong>用前缀索引</li><li><strong>联合索引</strong>优于多个单列索引</li><li>索引不是越多越好，影响写入性能</li><li>避免在索引列上做运算或函数</li></ol><h3 id="前缀索引" tabindex="-1"><a class="header-anchor" href="#前缀索引"><span>前缀索引</span></a></h3><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 对 email 前 10 个字符建索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">CREATE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> idx_email</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> ON</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user(email(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 选择合适的前缀长度（区分度接近原始字段）</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DISTINCT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> email) / </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(*) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> full_selectivity,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DISTINCT</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> LEFT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(email, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) / </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(*) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> prefix5,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">DISTINCT</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> LEFT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(email, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)) / </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">COUNT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(*) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">AS</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> prefix10</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sql-提示" tabindex="-1"><a class="header-anchor" href="#sql-提示"><span>SQL 提示</span></a></h2><div class="language-sql line-numbers-mode" data-highlighter="shiki" data-ext="sql" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-sql"><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 建议使用索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">USE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(idx_name) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;张三&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 忽略索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">IGNORE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(idx_name) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;张三&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- 强制使用索引</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">SELECT</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> * </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FROM</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> user </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">FORCE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> INDEX</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(idx_name) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">WHERE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> name</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;张三&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="索引常见问题" tabindex="-1"><a class="header-anchor" href="#索引常见问题"><span>索引常见问题</span></a></h2><h3 id="q1-为什么主键建议自增" tabindex="-1"><a class="header-anchor" href="#q1-为什么主键建议自增"><span>Q1: 为什么主键建议自增？</span></a></h3><p>自增主键顺序插入，性能好。非自增主键可能导致页分裂，影响性能。</p><h3 id="q2-为什么推荐使用整型主键" tabindex="-1"><a class="header-anchor" href="#q2-为什么推荐使用整型主键"><span>Q2: 为什么推荐使用整型主键？</span></a></h3><ul><li>整型比较快</li><li>占用空间小（二级索引存主键）</li><li>UUID 36 字节，无序，性能差</li></ul><h3 id="q3-什么时候不建索引" tabindex="-1"><a class="header-anchor" href="#q3-什么时候不建索引"><span>Q3: 什么时候不建索引？</span></a></h3><ul><li>数据量小（&lt; 几千条）</li><li>频繁更新的字段</li><li>区分度低的字段（如性别）</li></ul>`,44)])])}const p=i(e,[["render",n]]),r=JSON.parse('{"path":"/tutorials/database/mysql/mysql-index.html","title":"MySQL 索引","lang":"zh-CN","frontmatter":{"order":3,"description":"MySQL 索引 索引是帮助 MySQL 高效获取数据的有序数据结构。 索引结构 为什么用 B+Tree？ B+Tree 优势： 非叶子节点只存索引，单节点可存更多 key 叶子节点形成有序链表，支持范围查询 层级低（3 层可存 2000W+ 数据） B+Tree 结构 索引分类 按数据结构 按逻辑分类 InnoDB 索引分类 聚簇索引选取规则： 有主...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"MySQL 索引\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-12T08:44:14.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"友人\\",\\"url\\":\\"https://www.codermast.com\\",\\"email\\":\\"codermast@163.com\\"}]}"],["meta",{"property":"og:url","content":"https://www.golangclouds.com/tutorials/database/mysql/mysql-index.html"}],["meta",{"property":"og:site_name","content":"Golang 全栈指南"}],["meta",{"property":"og:title","content":"MySQL 索引"}],["meta",{"property":"og:description","content":"MySQL 索引 索引是帮助 MySQL 高效获取数据的有序数据结构。 索引结构 为什么用 B+Tree？ B+Tree 优势： 非叶子节点只存索引，单节点可存更多 key 叶子节点形成有序链表，支持范围查询 层级低（3 层可存 2000W+ 数据） B+Tree 结构 索引分类 按数据结构 按逻辑分类 InnoDB 索引分类 聚簇索引选取规则： 有主..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-12T08:44:14.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-12T08:44:14.000Z"}]]},"git":{"createdTime":1765529054000,"updatedTime":1765529054000,"contributors":[{"name":"友人","username":"","email":"codermast@qq.com","commits":1}]},"readingTime":{"minutes":3.79,"words":1138},"filePathRelative":"tutorials/database/mysql/mysql-index.md","autoDesc":true}');export{p as comp,r as data};
